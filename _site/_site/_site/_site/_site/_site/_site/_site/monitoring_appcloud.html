<h1>Monitoring</h1>

<p>Engine Yard AppCloud includes the ability to monitor your instances for CPU usage, free space, etc. so you're aware of any extreme resource usage as they happen.   Read more about Instance Monitoring and how to configure it for your environment.</p>

<p>We also recommend and offer an External Monitoring For a Rails App|external URL monitor checking service that will alert you if after two consecutive attempts if we've not been able to contact your URL with a HTTP 200 OK response.</p>

<h2>Instance Monitoring</h2>

<p>With <strong>Instance Monitoring</strong>, Engine Yard keeps an eye on your instance, records the alerts and optionally will email you.</p>

<h3>Enable Email Alerts</h3>

<p><strong>NOTE</strong>: Email alerts are disabled by default.</p>

<ul><li>Click on the <strong>Alerts</strong> tab.</li>
<li>Click on <strong>Enable email alerts</strong>.</li>
<li>Specify the email you want to receive the alerts.</li>
<li>Click on <strong>Update Alert Settings</strong> button.</li>
</ul><p>{{:appcloud:guides:enable_alerts.jpg?700|}}</p>

<p>Follow the above steps for each environment that you'd like to receive alerts for.  For instance you may not need to receive alerts for your "staging" environment, but rather you do want alerts for your "production" environment.</p>

<h3>View Alerts</h3>

<p><strong>NOTE</strong>: You can view the alerts, even if you have not specified an email to receive alerts.</p>

<h4>Most Recent</h4>

<p>See the three most current alerts.  Click on the <strong>Alerts</strong> tab.</p>

<p>{{:appcloud:guides:recent_alerts.jpg?700|}}</p>

<h4>All Alerts</h4>

<p>To see all recorded alerts click on the <strong>View All Alerts</strong> link.</p>

<p>{{:appcloud:guides:all_alerts.jpg?700|}}</p>

<h3>Understand Alerts</h3>

<h4>Load Average</h4>

<p>Something is consuming system resources.  If this is sustained for a long period it can warrant getting on the instance and troubleshooting.</p>

<p>Current Thresholds:</p>

<ul><li>Warn: 4 x VCPU</li>
<li>Fail: 10 x VCPU</li>
</ul><p>For example: a 1 VCPU, the load would be 4.00 but a 5 VCPU, it would be 20.00.</p>

<h4>IO-Wait</h4>

<p>The instance is waiting for disk writes to complete before it can move to other operations.</p>

<p>Current Thresholds:</p>

<ul><li>Warn: 40% iowait</li>
<li>Fail: 80% iowait</li>
</ul><h4>Swap Used</h4>

<p>This alerts when the Swap space is getting low.</p>

<p>Current Thresholds:</p>

<ul><li>Warn: 128 MB Swap Used</li>
<li>Fail: 384 MB Swap Used</li>
</ul><h4>Free Space on <code>/data</code></h4>

<p>You may not realize the instance is almost out of disk space until you get this alert.  This alert will help give you the warning you need in advance.</p>

<p>Current Thresholds:</p>

<ul><li>Warn: 1 GB</li>
<li>Fail: 256 MB</li>
</ul><h4>Free Space on <code>/db</code></h4>

<p>The database volume needs monitoring for free disk space as well.</p>

<p>Current Thresholds:</p>

<ul><li>Warn: 1 GB</li>
<li>Fail: 256 MB</li>
</ul><h2>External Monitoring For a Rails App</h2>

<p>Monitoring your site’s uptime is an important component to an overall strategy of keeping your site online and your visitors happy.</p>

<h3>Install the FitterHappier Plugin</h3>

<p><a href="http://github.com/atmos/fitter_happier/tree/master">FitterHappier</a> is a Rails plug-in that provides actions for monitoring site and/or database availability. FitterHappier’s monitoring controller disables unnecessary Rails features, like sessions, layouts, and logging, for lightning-fast monitoring URIs.</p>

<p>To install FitterHappier, run the following commands from the project root of your Rails application:</p>

<pre><code>cd vendor/plugins
git clone git://github.com/atmos/fitter_happier.git
</code></pre>

<p>For assurance, fire-up your application on your development machine and test the following URIs:</p>

<pre><code>curl localhost:3000/fitter_happier
FitterHappier Site Check Passed

curl localhost:3000/fitter_happier/site_check
FitterHappier Site Check Passed @ Wed, 17 Dec 2008 14:27:47 -0800

curl localhost:3000/fitter_happier/site_and_database_check
FitterHappier Site and Database Check Passed @ Wed, 17 Dec 2008 14:27:57 -0800
Schema Version: 20081217141904
</code></pre>

<h3>Update Your Production Environment</h3>

<p>Once successfully installed, commit the plug-in to your application’s repository and deploy.  Ensure deployment was successful by testing the same URIs from above.</p>

<h3>Adding the URL to AppCloud</h3>

<p>You can monitor one URL with Engine Yard AppCloud.  We'd suggest the <code>site_and_database_check</code> for optimal coverage.</p>

<ul><li>Start at the Dashboard for Engine Yard AppCloud.</li>
<li>For your environment, click on the <strong>Monitored URL</strong> tab.</li>
<li>Fill out the "URL to monitor" field and click the <strong>Add URL</strong> button.</li>
</ul><p>For example:</p>

<pre><code>http://yoursite.com/fitter_happier/site_and_database_check
</code></pre>

<p>If the URL returns a 200 OK HTTP response, you'll get an email confirming your site is up.  Now if the site goes down, or doesn't respond quickly, you'll be alerted via email!</p>

<p>The email is the account owner of the EY AppCloud account.</p>