<!DOCTYPE HTML>
<html>
  <head>
  
    <title>Engine Yard Docs: Getting Started with JRuby</title>
    <meta name="description" content="Learn why Engine Yard\'s managed Rails hosting, Rails deployment &amp; 24/7/365 live service is the best">
    <meta name="keywords" content="Ruby on Rails Fully-Managed Hosting, Scaling, Scaled, Cluster Slices, Cloud Computing, On-Demand Deployment, Merb, Rubinius, Open-Source Software">
    <meta http-equiv="expires" content="0">

    <!--[if IE]>
	  <script src="/javascripts/html5shiv"></script>
    <![endif]-->
    
	<link rel="stylesheet" href="/css/application.css" type="text/css" charset="utf-8" />
    
    <!--[if IE]>
	  <link rel="stylesheet" href="/css/ie.css" type="text/css" charset="utf-8" />
    <![endif]-->
    
    <!--[if lte IE 7]>
	  <link rel="stylesheet" href="/css/ie7.css" type="text/css" charset="utf-8" />
    <![endif]-->

    <script src="http://use.typekit.com/cra4agv.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="wrapper">
          <h1 class="branding">
              <a href="http://engineyard.com/">Ruby On Rails Hosting Management: Engine Yard Platform-as-a-Service</a> <!-- CHANGE ON GO LIVE -->
          </h1>

          <ul class="utility">
            <li>866-518-YARD</li>
            <li>
              <form action="/search" method="get" class="search">
                <input type="text" name="q" id="searchbox" placeholder="search" />
                <input type="submit" value="Search" class="gsc-search-button" />
              </form>
            </li>
            <li>
			  <a href="https://login.engineyard.com/signup" class="login">Create Account</a>
            </li>
            <li>
			  <a href="https://cloud.engineyard.com" class="login">Sign In</a>
            </li>
          </ul>

          <nav> <!-- CHANGE ON GO LIVE -->
		  <ul class="navigation">
		    <li>
		      <a href="http://engineyard.com/products/appcloud"><span>Cloud Products</span></a>
		      <ul>
		        <li>
		          <a href="http://engineyard.com/products/appcloud">Engine Yard AppCloud</a>
		          <ul>
		            <li><a href="http://engineyard.com/products/appcloud/features">Features</a></li>
		            <li><a href="http://engineyard.com/products/appcloud/pricing">Pricing</a></li>
		            <li><a href="http://engineyard.com/video/17825326">Video Tour</a></li>
		          </ul>
		        </li>
		        <li>
		          <a href="http://engineyard.com/products/xcloud">Engine Yard xCloud</a>
		          <ul>
		            <li><a href="http://engineyard.com/products/xcloud/features">Features</a></li>
		            <li><a href="http://engineyard.com/products/xcloud/pricing">Pricing</a></li>
		          </ul>
		        </li>
		        <li>
		          <a href="http://engineyard.com/products/technology">Engine Yard Platform</a>
		          <ul>
		            <li><a href="http://engineyard.com/products/technology/stack">Technology Stack</a></li>
		          </ul>
		        </li>
		      </ul>
		    </li>

		    <li>
		      <a href="http://engineyard.com/support-plans"><span>Support</span></a>
		      <ul>
		        <li><a href="http://engineyard.com/support-plans">Support Plans</a></li>
		        <li><a href="http://engineyard.com/services">Professional Services</a></li>
		      </ul>
		    </li>

		    <li>
			  <a href="http://engineyard.com/university"><span>EY University</span></a>	
		    </li>

		    <li>
		      <a href="http://engineyard.com/videos"><span>Resources</span></a>
		      <ul>
		        <li><a href="http://engineyard.com/videos">Videos</a></li>
		        <li><a href="http://engineyard.com/podcasts">Podcasts</a></li>
		        <li><a href="http://engineyard.com/developer/events">Events</a></li>
		        <li><a href="http://engineyard.com/partners">Development Partners</a></li>
		        <li><a href="http://engineyard.com/developer/groups">User Groups</a></li> 
		        <li><a href="http://jobs.engineyard.com">Jobs Board</a></li>
		      </ul>
		    </li>

		    <li>
		      <a href="http://engineyard.com/open-source"><span>Open Source</span></a>
		      <ul>
		        <li><a href="http://engineyard.com/open-source">Projects</a></li>
		        <li><a href="http://engineyard.com/open-source/people">Contributors</a></li>
		      </ul>
		    </li>

		    <li>
		      <a href="http://engineyard.com/company/"><span>About</span></a>
		      <ul>
		        <li><a href="http://engineyard.com/company/">Overview</a></li>
		        <li><a href="http://engineyard.com/company/customers">Customers</a></li>
		        <li><a href="http://engineyard.com/company/team">Leadership Team</a></li>
		        <li><a href="http://engineyard.com/company/partners">Technology Partners</a></li>
		        <li><a href="http://engineyard.com/company/careers">Careers</a></li>
		        <li><a href="http://engineyard.com/company/news">News &amp; Press</a></li>
		        <li><a href="http://engineyard.com/company/contact">Contact Us</a></li>
		      </ul>
		    </li>

		    <li>
		      <a href="http://engineyard.com/blog"><span>Blog</span></a>
		    </li>
		  </ul>
		</nav>
        </div>
      </header>

      <div id="content">
        <div class="wrapper">
			<h1>Getting Started with JRuby</h1>

<h2>Before starting</h2>

<ul><li>Do note that this is in a very early stage of development. See below for known issues.</li>
<li>Your application should use Bundler 1.0.1 or later to manage gems.</li>
<li>Gemfile must include glassfish (be sure that bundler resolves the version to 1.0.3 or later).</li>
</ul><h2>Preparing an existing Rails app</h2>

<ul><li>An example snippet to your Gemfile:</li>
</ul><p><code>
source 'http://gems.engineyard.com'</code></p>

<p>if defined?(JRUBY_VERSION)
  gem 'activerecord-jdbc-adapter'
  gem 'jruby-openssl'
  gem 'jdbc-mysql', :require =&gt; false
  gem 'jdbc-sqlite3', :require =&gt; false
  gem 'glassfish'
else
  gem 'sqlite3-ruby', :require =&gt; 'sqlite3'
end
</p>

<p>or, equivalently:</p>

<p><code>
gem 'activerecord-jdbc-adapter', :platforms =&gt; :jruby
gem 'jruby-openssl', :platforms =&gt; :jruby
gem 'jdbc-mysql', :require =&gt; false, :platforms =&gt; :jruby
gem 'jdbc-sqlite3', :require =&gt; false, :platforms =&gt; :jruby
gem 'glassfish', :platforms =&gt; :jruby
gem 'sqlite3-ruby', :require =&gt; 'sqlite3', :platforms =&gt; :ruby
</code></p>

<p>Then run these commands to update your Gemfile.lock:</p>

<p><code>
rvm install jruby
rvm jruby
bundle install
glassfish .</code></p>

<p>git checkout -b jruby
git commit -a -m "Gemfile updated for jruby/glassfish"
git push origin jruby</p>

<p>rvm 1.8.7
gem install engineyard --pre --source http://gems.engineyard.com
</p>

<p>If you are not using RVM, do this in <code>$RAILS_ROOT</code> to update <code>Gemfile</code>:</p>

<p><code>
jruby -S bundle bundle install
git add Gemfile<em>
git commit -m 'Update Gemfile</em> for JRuby'
git push
</code></p>

<p>(Use branch of your choice.)</p>

<ul><li><code>config.ru</code> needs to be modified to <code>require 'bundler/setup'</code> correctly before the first use of <code>Bundler</code>, like so:</li>
</ul><p><code>
  # This file is used by Rack-based servers to start the application.
  # Find the latest bundler and get started</code></p>

<p>require 'rbconfig'
$:.unshift(Dir[RbConfig::CONFIG["libdir"] + "/ruby/gems/1.8/gems/bundler-*/lib"].sort.last)
require 'bundler/setup'</p>

<p>require ::File.expand_path('../config/environment',  <strong>FILE</strong>)
run CloudstockDemo::Application
</p>

<h2>Steps</h2>

<ul><li>Choose <strong>Quick Start</strong> from the <strong>Server Management</strong> pane on the left.</li>
<li>Click on <strong>Next</strong>.</li>
<li>Fill in the repository URI, choose the application type and version.</li>
<li>Also choose <strong>Framework Environment</strong>, <strong>JRuby</strong> as your Ruby Runtime, and <strong>Glassfish</strong> as your Web Server Stack.</li>
<li>Click on <strong>Next</strong>.</li>
<li>You may be presented with a deploy key. In this case, install the deploy key in your repository as usual, and click <strong>Next</strong>.</li>
<li>If your application is running on Rails 3, Bundler will manage gems, so simply click <strong>Next</strong>. Otherwise, add gems as necessary.</li>
<li>Click on <strong>Next</strong>.</li>
<li>Optionally add SSH key as usual.</li>
<li>Click on <strong>Next</strong>.</li>
<li>Choose your server configuration as usual, and click on <strong>Boot This Configuration</strong>.</li>
<li>Note that this brings up the instances to a running state, but the application code is not deployed. To complete the application deployment, click on "Applications" in the environment box.</li>
<li>Click on <strong>Deploy</strong> button. Note, change "HEAD" to your jruby branch if necessary. Alternately, from the console.</li>
<li><p><strong><em>NOTE:</em></strong> If you have migrations, you must run them manually via SSH:</p>

<p>  <code>ey ssh</code></p>

<pre><code>cd /data/APPNAME/current
jruby -S rake db:migrate
</code></pre>

<p>  </p></li>
<li><p>Back in the Instances tab, click on "HTTP" link to view your application.</p></li>
</ul><h2>Known Issues</h2>

<p>We are aware of these issues and working on identifying and fixing the causes.</p>

<ul><li>Booting an environment does not completely deploy the application.</li>
<li>The "rake" command is not using the correct platform. <a href="https://tickets.engineyard.com/issue/SD-3420">ticket</a></li>
<li>Only one application is allowed. [ <a class="internal absent" href="/ticket.html">https://tickets.engineyard.com/issue/PL-2939</a> ]</li>
</ul><p>Also, not referenced above:</p>

<ul><li><code>engingeyard</code> gem is not supported on JRuby. There is a dependency on <code>ruby-termios</code> gem which depends on native C extension. This appears to have problems, even with the announced C extension support on JRuby.</li>
</ul>
		</div>
	</div>

      <div class="clear"></div> 

      <div id="footer">
        <div id="footer-content">
          <div class="page">
            <div class="grid_4">
              <p id="copyright">
                <p>   
                Running on Engine Yard: <a href="http://engineyard.com/products/appcloud">The Ruby Cloud</a> and <a href="http://github.com/github/gollum">Gollum</a><br /> <!-- CHANGE WHEN GO LIVE -->
                Ruby is the Language of the Cloud.<br />
                Copyright &copy; Engine Yard, Inc. All rights reserved.
              </p>
            </div>
            <div class="grid_2">
              <h2>Ruby Products</h2><!--CHANGE WHEN GO LIVE -->
              <ul>
                <li><a href="http://engineyard.com/products/appcloud">Engine Yard AppCloud</a></li>
                <li><a href="http://engineyard.com/products/xcloud">Engine Yard xCloud</a></li>
                <li><a href="http://engineyard.com/university/scheduled_classes">Rails 3 Training</a></li>
                <li><a href="http://engineyard.com/services">Professional Services</a></li>
              </ul>
            </div>
            <div class="grid_2">
              <h2>Customer Service</h2>  
              <ul>                       
                <li><a href="http://support.cloud.engineyard.com/">Request Support</a></li> 
                <li><a href="http://docs.engineyard.com">Documentation</a></li> 
                <li><a href="http://community.engineyard.com">Community Forums</a></li> 
                <li><a href="/products/support-policies">Support Policies</a></li>
                <li><a href="/legal/privacy">Privacy Policy</a></li>
              </ul>
            </div>
            <div class="grid_2">
              <h2>Ruby Community</h2>
              <ul>
                <li><a href="http://www.jruby.org">JRuby</a></li>
                <li><a href="http://rubini.us">Rubinius</a></li>
                <li><a href="http://www.railsinstaller.com">Rails Installer</a></li>
                <li><a href="http://jobs.engineyard.com">Ruby Jobs</a></li>
                <li><a href="http://www.railsdevelopment.com">Rails Developers</a></li>
              </ul>
            </div>
            <div class="grid_2">
              <h2>Socialize With Us</h2>
              <ul>
                <li>
					<a href="http://engineyard.com/blog" class="blog">Blog</a> <!--CHANGE WHEN LIVE-->
                </li>
                <li>
					<a href="http://twitter.com/engineyard" class="twitter trackLink">Twitter</a>
                </li>
                <li>                                                                             
					<a href="http://facebook.com/engineyard" class="facebook trackLink">Facebook</a>
                </li>
                <li>                                                                             
					<a href="http://www.linkedin.com/groups?gid=111752" class="linkedin trackLink">LinkedIn</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>           
    </div>

    <div class="hidden">
	  <script src="/javascripts/application.min.js"></script>
    </div>
  </body>
</html>